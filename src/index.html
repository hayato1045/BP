<!DOCTYPE html>
<html lang="ja">

<head>

  <meta charset="utf-8" />
  <title>BOOKPLACE</title>
  <base href="/" />

  <meta name="viewport"
    content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />

  <link rel="icon" type="image/png" href="assets/icon/favicon.png" />

  <!-- add to homescreen for ios -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-title" content="BOOK PLACE">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#15923B">
  <link rel="apple-touch-icon" href="/assets/BOOKPLACE-logo.png" sizes="114x114">
  <link rel="apple-touch-icon" href="/assets/BOOKPLACE-logo.png" sizes="120x120">
  <link rel="apple-touch-icon" href="/assets/BOOKPLACE-logo.png" sizes="144x144">
</head>

<body>
  <app-root></app-root>
  <noscript>Please enable JavaScript to continue using this application.</noscript>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script
    src="https://maps.google.com/maps/api/js?key=AIzaSyBhljMO2LmCNaCBUkZITdhccYO91doZB2o&amp;language=ja"></script>
  <script>
  //   <script async defer
  //   src="https://maps.google.com/maps/api/js?key=AIzaSyBhljMO2LmCNaCBUkZITdhccYO91doZB2o&amp;language=ja"></script>
  //
  <script>


    function initMap() {

      //初期位置に、上記配列の一番初めの緯度経度を格納
      if (navigator.geolocation) {
        // 現在地を取得
        navigator.geolocation.getCurrentPosition(

          // 取得成功した場合
          function (position) {
            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            var opts = {
              zoom: 15,          // 拡大倍率
              center: latlng,  // 緯度・経度
            };

            var opts = {
              // zoom: 8,//地図の縮尺
              zoom: 15,//地図の縮尺
              center: latlng, //初期位置の変数
              mapTypeId: google.maps.MapTypeId.ROADMAP,
              disableDefaultUI: true
            }; // マップオブジェクト作成

            var map = new google.maps.Map(
              document.getElementById("map"), // マップを表示する要素
              opts         // マップオプション
            );


            //マップにマーカーを表示する
            var currentlocation = new google.maps.Marker({
              map: map,             // 対象の地図オブジェクト
              position: latlng   // 緯度・経度
            });

            // var marker = new google.maps.Marker({
            //   map: map,             // 対象の地図オブジェクト
            //   position: new google.maps.LatLng(35.562753, 139.716135), // 緯度・経度
            //   icon: 'assets/pin.svg',
            // });
            var cafe = new google.maps.Marker({
              map: map,             // 対象の地図オブジェクト
              position: new google.maps.LatLng(35.562753, 139.716135), // 緯度・経度
              icon: 'assets/pin.svg',
              zoom: 15,
            });

            var bakery = new google.maps.Marker({
              map: map,             // 対象の地図オブジェクト
              position: new google.maps.LatLng(35.571647, 139.717652), // 緯度・経度
              icon: 'assets/pin.svg',
              zoom: 15,
            });

            var sweets = new google.maps.Marker({
              map: map,             // 対象の地図オブジェクト
              position: new google.maps.LatLng(35.569619, 139.707603), // 緯度・経度
              icon: 'assets/pin.svg',
              zoom: 15,
            });

            // google.maps.event.addListener(cafe, 'click', function (event) {
            //   $('#shop-bakery').css('display', 'none');
            //   $('#shop-sweets').css('display', 'none');
            //   $('#shop-cafe').slideToggle();
            //   map.panTo(new google.maps.LatLng(35.562753, 139.716135));
            //   $('#currentlocation').toggleClass('active');
            //   $('#search').toggleClass('active');
            // });


            google.maps.event.addListener(cafe, 'click', function (event) {
              $('#shop-bakery').css('display', 'none');
              $('#shop-sweets').css('display', 'none');
              $('#shop-cafe').slideToggle();

              if ($("#shop-cafe").hasClass("active")) {
                $('#shop-cafe').removeClass("active");
              } else if (!$("#shop-cafe").hasClass("active")) {
                $('#shop-cafe').addClass('active');
              }
              map.panTo(new google.maps.LatLng(35.562753, 139.716135));
              // $('#currentlocation').toggleClass('active');
              // $('#search').toggleClass('active');
              if (($("#shop-sweets").hasClass("active")) || ($("#shop-bakery").hasClass("active"))) {
                $('#shop-sweets').removeClass("active");
                $('#shop-bakery').removeClass("active");
              } else if ($("#shop-cafe").hasClass("active")) {
                $('#currentlocation').toggleClass('active');
                $('#search').toggleClass('active');
              } else {
                $('#currentlocation').toggleClass('active');
                $('#search').toggleClass('active');
              }



            });

            google.maps.event.addListener(bakery, 'click', function (event) {
              $('#shop-cafe').css('display', 'none');
              $('#shop-sweets').css('display', 'none');
              $('#shop-bakery').slideToggle();

              if ($("#shop-bakery").hasClass("active")) {
                $('#shop-bakery').removeClass("active");
              } else if (!$("#shop-bakery").hasClass("active")) {
                $('#shop-bakery').addClass('active');
              }
              map.panTo(new google.maps.LatLng(35.571647, 139.717652));
              // $('#currentlocation').toggleClass('active');
              // $('#search').toggleClass('active');

              if (($("#shop-sweets").hasClass("active")) || ($("#shop-cafe").hasClass("active"))) {
                // console.log("正解");
                $('#shop-cafe').removeClass("active");
                $('#shop-sweets').removeClass("active");
              } else if (!$("#shop-bakery").hasClass("active")) {
                $('#currentlocation').toggleClass('active');
                // console.log("微妙")
                $('#search').toggleClass('active');
              } else {
                $('#currentlocation').toggleClass('active');
                // console.log("不正解")
                $('#search').toggleClass('active');
              }
              // if (($("#shop-sweets").hasClass("active")) || ($("#shop-cafe").hasClass("active"))) {
              //   console.log("正解")
              // } else if (!$("#shop-bakery").hasClass("active")) {
              //   $('#currentlocation').toggleClass('active');
              //   console.log("微妙")
              // } else {
              //   $('#currentlocation').toggleClass('active');
              //   console.log("不正解")
              // }



            });

            google.maps.event.addListener(sweets, 'click', function (event) {
              $('#shop-cafe').css('display', 'none');
              $('#shop-bakery').css('display', 'none');
              $('#shop-sweets').slideToggle();

              if ($("#shop-sweets").hasClass("active")) {
                $('#shop-sweets').removeClass("active");
              } else if (!$("#shop-sweets").hasClass("active")) {
                $('#shop-sweets').addClass('active');
              }
              map.panTo(new google.maps.LatLng(35.570116, 139.708308));
              // $('#currentlocation').toggleClass('active');
              // $('#search').toggleClass('active');
              if (($("#shop-cafe").hasClass("active")) || ($("#shop-bakery").hasClass("active"))) {
                $('#shop-cafe').removeClass("active");
                $('#shop-bakery').removeClass("active");
              } else if (!$("#shop-sweets").hasClass("active")) {
                $('#currentlocation').toggleClass('active');
                $('#search').toggleClass('active');
              } else {
                $('#currentlocation').toggleClass('active');
                $('#search').toggleClass('active');
              }




            });



            google.maps.event.addListener(map, 'click', function (event) {
              $('#shop-cafe').css('display', 'none');
              $('#shop-bakery').css('display', 'none');
              $('#shop-sweets').css('display', 'none');
              $('#currentlocation').removeClass('active');
              $('#search').removeClass('active');
              $('#shop-sweets').removeClass("active");
              $('#shop-cafe').removeClass("active");
              $('#shop-bakery').removeClass("active");
            });


            $('#currentlocation').click(function () {
              if ($("#currentlocation").hasClass("active")) {
                $('#currentlocation').removeClass("active");
                $('#search').removeClass('active');
              } else if (!$("#currentlocation").hasClass("active")) {
              }
              // $('#currentlocation').toggleClass('active');
              // $('#search').toggleClass('active');
              $('#shop-cafe').css('display', 'none');
              $('#shop-bakery').css('display', 'none');
              $('#shop-sweets').css('display', 'none');
              map.panTo(latlng);
              // map.setZoom(map.getZoom(1));
              map.setZoom(15);
            });

            $('#tab-button-tab2').click(function () {
              $('#shop-cafe').css('display', 'none');
              $('#shop-bakery').css('display', 'none');
              $('#shop-sweets').css('display', 'none');
              map.panTo(latlng);
              // map.setZoom(map.getZoom(1));
              map.setZoom(15);
            });






            // $('#cafe').click(function () {
            //   $('#shop-cafe').slideToggle();
            //   $('#currentlocation').toggleClass('active');
            //   $('#search').toggleClass('active');
            //   map.panTo(cafe.position);
            // });
            // $('#sweets').click(function () {
            //   $('#shop-sweets').slideToggle();
            //   $('#currentlocation').toggleClass('active');
            //   $('#search').toggleClass('active');
            //   map.panTo(sweets.position);
            // });
            // $('#bakery').click(function () {
            //   $('#shop-bakery').slideToggle();
            //   $('#currentlocation').toggleClass('active');
            //   $('#search').toggleClass('active');
            //   map.panTo(bakery.position);
            // });
            $(document).on('click', '#cafe', function () {
              $('#shop-cafe').slideToggle();
              $('#currentlocation').toggleClass('active');
              $('#search').toggleClass('active');
              map.panTo(cafe.position);
              $('#shop-cafe').addClass('active');
            });
            $(document).on('click', '#sweets', function () {
              $('#shop-sweets').slideToggle();
              $('#currentlocation').toggleClass('active');
              $('#search').toggleClass('active');
              map.panTo(sweets.position);
              $('#shop-sweets').addClass('active');
            });
            $(document).on('click', '#bakery', function () {
              $('#shop-bakery').slideToggle();
              $('#currentlocation').toggleClass('active');
              $('#search').toggleClass('active');
              map.panTo(bakery.position);
              $('#shop-bakery').addClass('active');
            });










          },


          function (error) {
            // エラーメッセージを表示
            switch (error.code) {
              case 1: // PERMISSION_DENIED
                alert("位置情報の利用が許可されていません");
                break;
              case 2: // POSITION_UNAVAILABLE
                alert("現在位置が取得できませんでした");
                break;
              case 3: // TIMEOUT
                alert("タイムアウトになりました");
                break;
              default:
                alert("その他のエラー(エラーコード:" + error.code + ")");
                break;
            }
          },
        );
        // Geolocation APIに対応していない
      } else {
        alert("この端末では位置情報が取得できません");

      }
      $('#search').click(function () {
        $('#search-bar').toggleClass('active');
        $('#search-list').toggleClass('active');
        $('#map').toggleClass('active');
        $('#shop-cafe').css('display', 'none');
        $('#shop-bakery').css('display', 'none');
        $('#shop-sweets').css('display', 'none');
        $('#currentlocation').toggleClass('hide');
        $('#currentlocation').removeClass('active');
        $('#search').removeClass('active');

        $('#shop-sweets').removeClass("active");
        $('#shop-cafe').removeClass("active");
        $('#shop-bakery').removeClass("active");
        // $('ion-searchbar').css('display', 'block');
        // $('ion-list').css('display', 'block');
        // $('#map').css('display', 'none');
      });

      $('.search-img').click(function () {
        if ($(this).hasClass('open') == false) {
          $(this).attr('src', '/assets/search.svg').addClass('open');
        } else {
          $(this).attr('src', '/assets/close.svg').removeClass('open');
        }

      });
      // $('ion-item').click(function () {
      //   $('#map').removeClass('active');
      //   $('#search-bar').removeClass('active');
      //   $('#search-list').removeClass('active');
      //   $('#currentlocation').removeClass('hide');
      //   $('.search-img').attr('src', '/assets/search.svg').addClass('open');
      //   // map.panTo(item.location);
      // });
      $(document).on('click', 'ion-item', function () {
        $('#map').removeClass('active');
        $('#search-bar').removeClass('active');
        $('#search-list').removeClass('active');
        $('#currentlocation').removeClass('hide');
        $('.search-img').attr('src', '/assets/search.svg').addClass('open');
        // map.panTo(item.location);
      });

    }

    //地図描画を実行
    // google.maps.event.addDomListener(window, 'load', initMap);
    window.onload = function () {
      initMap();
    }
    var slides = document.querySelector('ion-slides');

    // Optional parameters to pass to the swiper instance. See http://idangero.us/swiper/api/ for valid options.

  </script>
</body>

</html>